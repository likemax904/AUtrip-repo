<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>行程規劃</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              "primary-blue": "#1E40AF",
              "secondary-yellow": "#FBBF24",
              "bg-gray": "#F9FAFB",
            },
            fontFamily: {
              sans: ["Noto Sans TC", "Inter", "sans-serif"],
            },
          },
        },
      };
    </script>
    <style>
      .custom-scroll::-webkit-scrollbar {
        width: 8px;
      }
      .custom-scroll::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 4px;
      }
      .custom-scroll::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 4px;
      }
      /* 確保 active 樣式夠明顯 */
      .tab-active {
        border-bottom: 3px solid #1e40af;
        color: #1e40af; /* 讓文字也變色，更明顯 */
      }
      .map-frame iframe {
        width: 100% !important;
        height: 100% !important;
      }
    </style>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      xintegrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+HK:wght@100..900&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="">
    <!-- Header -->
    <header
      class="bg-white shadow-sm rounded-xl p-4 mb-6 flex justify-between items-center hidden"
    >
      <div>
        <h1 class="text-2xl font-bold text-gray-800 flex items-center">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 text-primary-blue mr-2"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.828 0l-4.243-4.243a8 8 0 1111.314 0z"
            />
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
            />
          </svg>
          澳洲十日行程
        </h1>
        <p
          id="connection-status"
          class="text-xs text-gray-500 mt-1 font-semibold flex items-center"
        >
          <span class="w-2 h-2 bg-gray-400 rounded-full mr-2"></span>
          檢查連線中...
        </p>
      </div>
      <button
        onclick="window.location.reload()"
        class="text-gray-500 hover:text-gray-700 text-sm border p-2 rounded hover:bg-gray-50 transition"
      >
        重新整理
      </button>
    </header>
    <div
      id="app"
      class="g-white shadow-sm rounded-xl sticky top-0 z-50 bg-white/90 backdrop-blur shadow-sm"
    >
      <nav
        class="flex space-x-4 border-b border-gray-200 mb-6 bg-white p-2 rounded-xl shadow-sm my-4"
      >
        <!-- 
             修改重點：
             1. 移除 onclick="" 事件，因為頁面跳轉後 JS 狀態會重置。
             2. 移除 button ID (除非 JS 有其他用途)，避免混淆。
             3. 依賴 Flask 傳入的 active_page 變數來設定 class。
        -->
        <a href="/">
          <button
            class="py-3 px-4 text-lg font-bold hover:text-primary-blue transition duration-150 {{ 'tab-active' if active_page == 'home' else 'text-gray-700' }}"
            onclick="switchTab('planner')"
          >
            首頁
          </button>
        </a>
        <a href="/itinerary">
          <button
            class="py-3 px-4 text-lg font-bold hover:text-primary-blue transition duration-150 {{ 'tab-active' if active_page == 'itinerary' else 'text-gray-700' }}"
            onclick="switchTab('planner')"
          >
            行程總覽
          </button>
        </a>
        <a href="/expenses-content">
          <button
            class="py-3 px-4 text-lg font-bold hover:text-primary-blue transition duration-150 {{ 'tab-active' if active_page == 'expenses' else 'text-gray-700' }}"
            onclick="switchTab('planner')"
          >
            費用統計
          </button>
        </a>
      </nav>
    </div>
    {% block content%}{%endblock%}
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <!-- 你的主 JS -->
    <script src="{{ url_for('static', filename='js/index.js') }}"></script>
  </body>
</html>
